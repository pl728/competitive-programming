<div class="problem-statement">
 <div class="header">
  <div class="title">
   E2. Daleks' Invasion (medium)
  </div>
  <div class="time-limit">
   <div class="property-title">
    time limit per test
   </div>15 seconds
  </div>
  <div class="memory-limit">
   <div class="property-title">
    memory limit per test
   </div>256 megabytes
  </div>
  <div class="input-file">
   <div class="property-title">
    input
   </div>standard input
  </div>
  <div class="output-file">
   <div class="property-title">
    output
   </div>standard output
  </div>
 </div>
 <div>
  <p>After a successful field test, Heidi is considering deploying a trap along some Corridor, possibly not the first one. She wants to avoid meeting the Daleks inside the Time Vortex, so for abundance of caution she considers placing the traps <span class="tex-font-style-underline">only</span> along those Corridors that are <span class="tex-font-style-underline">not</span> going to be used according to the current Daleks' plan – which is to use a minimum spanning tree of Corridors. Heidi knows that all energy requirements for different Corridors are now different, and that the Daleks have a single unique plan which they are intending to use.</p>
  <p>Your task is to calculate the number $E_{max}(c)$, which is defined in the same way as in the easy version – i.e., the largest $e \le 10^9$ such that if we changed the energy of corridor $c$ to $e$, the Daleks might use it – but now for <span class="tex-font-style-it">every</span> corridor that Heidi considers. </p>
 </div>
 <div class="input-specification">
  <div class="section-title">
   Input
  </div>
  <p>The first line: number $n$ of destinations, number $m$ of Time Corridors ($2 \leq n \leq 10^5$, $n - 1 \leq m \leq 10^6$). The next $m$ lines: destinations $a$, $b$ and energy $e$ ($1 \leq a, b \leq n$, $a \neq b$, $0 \leq e \leq 10^9$).</p>
  <p>No pair $\{a, b\}$ will repeat. The graph is guaranteed to be connected. All energy requirements $e$ are distinct.</p>
 </div>
 <div class="output-specification">
  <div class="section-title">
   Output
  </div>
  <p>Output $m-(n-1)$ lines, each containing one integer: $E_{max}(c_i)$ for the $i$-th Corridor $c_i$ from the input that is not part of the current Daleks' plan (minimum spanning tree).</p>
 </div>
 <div class="sample-tests">
  <div class="section-title">
   Example
  </div>
  <div class="sample-test">
   <div class="input">
    <div class="title">
     Input
    </div>
    <pre>3 3<br>1 2 8<br>2 3 3<br>3 1 4<br></pre>
   </div>
   <div class="output">
    <div class="title">
     Output
    </div>
    <pre>4<br></pre>
   </div>
  </div>
 </div>
 <div class="note">
  <div class="section-title">
   Note
  </div>
  <p>If $m = n-1$, then you need not output anything.</p>
 </div>
</div>